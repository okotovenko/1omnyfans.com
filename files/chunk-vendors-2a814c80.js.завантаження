"use strict";(self["webpackChunkof_vue"]=self["webpackChunkof_vue"]||[]).push([[1619],{197955:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a,n=r(468588),o=r(1455),s=r(677939),h=r(653774),l=r(354417),d=r(498479),u="hasShadow",c="shadowRGBA",p="patternImage",f="linearGradient",g="radialGradient";function y(){return a||(a=n.Util.createCanvasElement().getContext("2d"),a)}function m(t){t.fill()}function v(t){t.stroke()}function _(t){t.fill()}function S(t){t.stroke()}function b(){this._clearCache(u)}function w(){this._clearCache(c)}function G(){this._clearCache(p)}function C(){this._clearCache(f)}function x(){this._clearCache(g)}e.shapes={};var F=function(t){function r(r){var i,a=t.call(this,r)||this;while(1)if(i=n.Util.getRandomColor(),i&&!(i in e.shapes))break;return a.colorKey=i,e.shapes[i]=a,a.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",b),a.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),a.on("fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva",G),a.on("fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",C),a.on("fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",x),a}return i(r,t),r.prototype.getContext=function(){return this.getLayer().getContext()},r.prototype.getCanvas=function(){return this.getLayer().getCanvas()},r.prototype.getSceneFunc=function(){return this.attrs.sceneFunc||this["_sceneFunc"]},r.prototype.getHitFunc=function(){return this.attrs.hitFunc||this["_hitFunc"]},r.prototype.hasShadow=function(){return this._getCache(u,this._hasShadow)},r.prototype._hasShadow=function(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())},r.prototype._getFillPattern=function(){return this._getCache(p,this.__getFillPattern)},r.prototype.__getFillPattern=function(){if(this.fillPatternImage()){var t=y(),e=t.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");return e}},r.prototype._getLinearGradient=function(){return this._getCache(f,this.__getLinearGradient)},r.prototype.__getLinearGradient=function(){var t=this.fillLinearGradientColorStops();if(t){for(var e=y(),r=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),a=e.createLinearGradient(r.x,r.y,i.x,i.y),n=0;n<t.length;n+=2)a.addColorStop(t[n],t[n+1]);return a}},r.prototype._getRadialGradient=function(){return this._getCache(g,this.__getRadialGradient)},r.prototype.__getRadialGradient=function(){var t=this.fillRadialGradientColorStops();if(t){for(var e=y(),r=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),a=e.createRadialGradient(r.x,r.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius()),n=0;n<t.length;n+=2)a.addColorStop(t[n],t[n+1]);return a}},r.prototype.getShadowRGBA=function(){return this._getCache(c,this._getShadowRGBA)},r.prototype._getShadowRGBA=function(){if(this.hasShadow()){var t=n.Util.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}},r.prototype.hasFill=function(){return this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())},r.prototype.hasStroke=function(){return this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())},r.prototype.hasHitStroke=function(){var t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t},r.prototype.intersects=function(t){var e,r=this.getStage(),i=r.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i),e=i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0},r.prototype.destroy=function(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this},r.prototype._useBufferCanvas=function(t){return!(t&&!this.hasShadow()||!this.perfectDrawEnabled()||1===this.getAbsoluteOpacity()||!this.hasFill()||!this.hasStroke()||!this.getStage())},r.prototype.setStrokeHitEnabled=function(t){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)},r.prototype.getStrokeHitEnabled=function(){return 0!==this.hitStrokeWidth()},r.prototype.getSelfRect=function(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}},r.prototype.getClientRect=function(t){t=t||{};var e=t.skipTransform,r=t.relativeTo,i=this.getSelfRect(),a=!t.skipStroke&&this.hasStroke(),n=a&&this.strokeWidth()||0,o=i.width+n,s=i.height+n,h=!t.skipShadow&&this.hasShadow(),l=h?this.shadowOffsetX():0,d=h?this.shadowOffsetY():0,u=o+Math.abs(l),c=s+Math.abs(d),p=h&&this.shadowBlur()||0,f=u+2*p,g=c+2*p,y=0;Math.round(n/2)!==n/2&&(y=1);var m={width:f+y,height:g+y,x:-Math.round(n/2+p)+Math.min(l,0)+i.x,y:-Math.round(n/2+p)+Math.min(d,0)+i.y};return e?m:this._transformedRect(m,r)},r.prototype.drawScene=function(t,e,r,i){var a,n,o,s=this.getLayer(),h=t||s.getCanvas(),l=h.getContext(),d=this._getCanvasCache(),u=this.sceneFunc(),c=this.hasShadow(),p=this.hasStroke();if(!this.isVisible()&&!r)return this;if(d)return l.save(),s._applyTransform(this,l,e),this._drawCachedSceneCanvas(l),l.restore(),this;if(!u)return this;if(l.save(),this._useBufferCanvas(r)&&!i){if(a=this.getStage(),n=a.bufferCanvas,o=n.getContext(),o.clear(),o.save(),o._applyLineJoin(this),!r)if(s)s._applyTransform(this,o,e);else{var f=this.getAbsoluteTransform(e).getMatrix();l.transform(f[0],f[1],f[2],f[3],f[4],f[5])}u.call(this,o,this),o.restore();var g=n.pixelRatio;c&&!h.hitCanvas?(l.save(),l._applyShadow(this),l._applyOpacity(this),l._applyGlobalCompositeOperation(this),l.drawImage(n._canvas,0,0,n.width/g,n.height/g),l.restore()):(l._applyOpacity(this),l._applyGlobalCompositeOperation(this),l.drawImage(n._canvas,0,0,n.width/g,n.height/g))}else{if(l._applyLineJoin(this),!r)if(s)s._applyTransform(this,l,e);else{var y=this.getAbsoluteTransform(e).getMatrix();l.transform(y[0],y[1],y[2],y[3],y[4],y[5])}c&&p&&!h.hitCanvas?(l.save(),r||(l._applyOpacity(this),l._applyGlobalCompositeOperation(this)),l._applyShadow(this),u.call(this,l,this),l.restore(),this.hasFill()&&this.shadowForStrokeEnabled()&&u.call(this,l,this)):c&&!h.hitCanvas?(l.save(),r||(l._applyOpacity(this),l._applyGlobalCompositeOperation(this)),l._applyShadow(this),u.call(this,l,this),l.restore()):(r||(l._applyOpacity(this),l._applyGlobalCompositeOperation(this)),u.call(this,l,this))}return l.restore(),this},r.prototype.drawHit=function(t,e,r){var i=this.getLayer(),a=t||i.hitCanvas,o=a&&a.getContext(),s=this.hitFunc()||this.sceneFunc(),h=this._getCanvasCache(),l=h&&h.hit;if(this.colorKey||(console.log(this),n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. See the shape in logs above. If you want to reuse shape you should call remove() instead of destroy()")),!this.shouldDrawHit()&&!r)return this;if(l)return o.save(),i._applyTransform(this,o,e),this._drawCachedHitCanvas(o),o.restore(),this;if(!s)return this;if(o.save(),o._applyLineJoin(this),!r)if(i)i._applyTransform(this,o,e);else{var d=this.getAbsoluteTransform(e).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5])}return s.call(this,o,this),o.restore(),this},r.prototype.drawHitFromCache=function(t){void 0===t&&(t=0);var e,r,i,a,o,s,h=this._getCanvasCache(),l=this._getCachedSceneCanvas(),d=h.hit,u=d.getContext(),c=d.getWidth(),p=d.getHeight();u.clear(),u.drawImage(l._canvas,0,0,c,p);try{for(e=u.getImageData(0,0,c,p),r=e.data,i=r.length,a=n.Util._hexToRgb(this.colorKey),o=0;o<i;o+=4)s=r[o+3],s>t?(r[o]=a.r,r[o+1]=a.g,r[o+2]=a.b,r[o+3]=255):r[o+3]=0;u.putImageData(e,0,0)}catch(f){n.Util.error("Unable to draw hit graph from cached scene canvas. "+f.message)}return this},r.prototype.hasPointerCapture=function(t){return d.hasPointerCapture(t,this)},r.prototype.setPointerCapture=function(t){d.setPointerCapture(t,this)},r.prototype.releaseCapture=function(t){d.releaseCapture(t,this)},r}(s.Node);e.Shape=F,F.prototype._fillFunc=m,F.prototype._strokeFunc=v,F.prototype._fillFuncHit=_,F.prototype._strokeFuncHit=S,F.prototype._centroid=!1,F.prototype.nodeType="Shape",l._registerNode(F),o.Factory.addGetterSetter(F,"stroke",void 0,h.getStringValidator()),o.Factory.addGetterSetter(F,"strokeWidth",2,h.getNumberValidator()),o.Factory.addGetterSetter(F,"hitStrokeWidth","auto",h.getNumberOrAutoValidator()),o.Factory.addGetterSetter(F,"strokeHitEnabled",!0,h.getBooleanValidator()),o.Factory.addGetterSetter(F,"perfectDrawEnabled",!0,h.getBooleanValidator()),o.Factory.addGetterSetter(F,"shadowForStrokeEnabled",!0,h.getBooleanValidator()),o.Factory.addGetterSetter(F,"lineJoin"),o.Factory.addGetterSetter(F,"lineCap"),o.Factory.addGetterSetter(F,"sceneFunc"),o.Factory.addGetterSetter(F,"hitFunc"),o.Factory.addGetterSetter(F,"dash"),o.Factory.addGetterSetter(F,"dashOffset",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"shadowColor",void 0,h.getStringValidator()),o.Factory.addGetterSetter(F,"shadowBlur",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"shadowOpacity",1,h.getNumberValidator()),o.Factory.addComponentsGetterSetter(F,"shadowOffset",["x","y"]),o.Factory.addGetterSetter(F,"shadowOffsetX",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"shadowOffsetY",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"fillPatternImage"),o.Factory.addGetterSetter(F,"fill",void 0,h.getStringValidator()),o.Factory.addGetterSetter(F,"fillPatternX",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"fillPatternY",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"fillLinearGradientColorStops"),o.Factory.addGetterSetter(F,"strokeLinearGradientColorStops"),o.Factory.addGetterSetter(F,"fillRadialGradientStartRadius",0),o.Factory.addGetterSetter(F,"fillRadialGradientEndRadius",0),o.Factory.addGetterSetter(F,"fillRadialGradientColorStops"),o.Factory.addGetterSetter(F,"fillPatternRepeat","repeat"),o.Factory.addGetterSetter(F,"fillEnabled",!0),o.Factory.addGetterSetter(F,"strokeEnabled",!0),o.Factory.addGetterSetter(F,"shadowEnabled",!0),o.Factory.addGetterSetter(F,"dashEnabled",!0),o.Factory.addGetterSetter(F,"strokeScaleEnabled",!0),o.Factory.addGetterSetter(F,"fillPriority","color"),o.Factory.addComponentsGetterSetter(F,"fillPatternOffset",["x","y"]),o.Factory.addGetterSetter(F,"fillPatternOffsetX",0,h.getNumberValidator()),o.Factory.addGetterSetter(F,"fillPatternOffsetY",0,h.getNumberValidator()),o.Factory.addComponentsGetterSetter(F,"fillPatternScale",["x","y"]),o.Factory.addGetterSetter(F,"fillPatternScaleX",1,h.getNumberValidator()),o.Factory.addGetterSetter(F,"fillPatternScaleY",1,h.getNumberValidator()),o.Factory.addComponentsGetterSetter(F,"fillLinearGradientStartPoint",["x","y"]),o.Factory.addComponentsGetterSetter(F,"strokeLinearGradientStartPoint",["x","y"]),o.Factory.addGetterSetter(F,"fillLinearGradientStartPointX",0),o.Factory.addGetterSetter(F,"strokeLinearGradientStartPointX",0),o.Factory.addGetterSetter(F,"fillLinearGradientStartPointY",0),o.Factory.addGetterSetter(F,"strokeLinearGradientStartPointY",0),o.Factory.addComponentsGetterSetter(F,"fillLinearGradientEndPoint",["x","y"]),o.Factory.addComponentsGetterSetter(F,"strokeLinearGradientEndPoint",["x","y"]),o.Factory.addGetterSetter(F,"fillLinearGradientEndPointX",0),o.Factory.addGetterSetter(F,"strokeLinearGradientEndPointX",0),o.Factory.addGetterSetter(F,"fillLinearGradientEndPointY",0),o.Factory.addGetterSetter(F,"strokeLinearGradientEndPointY",0),o.Factory.addComponentsGetterSetter(F,"fillRadialGradientStartPoint",["x","y"]),o.Factory.addGetterSetter(F,"fillRadialGradientStartPointX",0),o.Factory.addGetterSetter(F,"fillRadialGradientStartPointY",0),o.Factory.addComponentsGetterSetter(F,"fillRadialGradientEndPoint",["x","y"]),o.Factory.addGetterSetter(F,"fillRadialGradientEndPointX",0),o.Factory.addGetterSetter(F,"fillRadialGradientEndPointY",0),o.Factory.addGetterSetter(F,"fillPatternRotation",0),o.Factory.backCompat(F,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),n.Collection.mapMethods(F)},468588:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var i=r(354417),a=function(){function t(){}return t.toCollection=function(e){var r,i=new t,a=e.length;for(r=0;r<a;r++)i.push(e[r]);return i},t._mapMethod=function(e){t.prototype[e]=function(){var t,r=this.length,i=[].slice.call(arguments);for(t=0;t<r;t++)this[t][e].apply(this[t],i);return this}},t.mapMethods=function(e){var r=e.prototype;for(var i in r)t._mapMethod(i)},t}();e.Collection=a,a.prototype=[],a.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},a.prototype.toArray=function(){var t,e=[],r=this.length;for(t=0;t<r;t++)e.push(this[t]);return e};var n=function(){function t(t){void 0===t&&(t=[1,0,0,1,0,0]),this.m=t&&t.slice()||[1,0,0,1,0,0]}return t.prototype.copy=function(){return new t(this.m)},t.prototype.point=function(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}},t.prototype.translate=function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},t.prototype.scale=function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.m[0]*e+this.m[2]*r,a=this.m[1]*e+this.m[3]*r,n=this.m[0]*-r+this.m[2]*e,o=this.m[1]*-r+this.m[3]*e;return this.m[0]=i,this.m[1]=a,this.m[2]=n,this.m[3]=o,this},t.prototype.getTranslation=function(){return{x:this.m[4],y:this.m[5]}},t.prototype.skew=function(t,e){var r=this.m[0]+this.m[2]*e,i=this.m[1]+this.m[3]*e,a=this.m[2]+this.m[0]*t,n=this.m[3]+this.m[1]*t;return this.m[0]=r,this.m[1]=i,this.m[2]=a,this.m[3]=n,this},t.prototype.multiply=function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],r=this.m[1]*t.m[0]+this.m[3]*t.m[1],i=this.m[0]*t.m[2]+this.m[2]*t.m[3],a=this.m[1]*t.m[2]+this.m[3]*t.m[3],n=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=n,this.m[5]=o,this},t.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,r=-this.m[1]*t,i=-this.m[2]*t,a=this.m[0]*t,n=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=r,this.m[2]=i,this.m[3]=a,this.m[4]=n,this.m[5]=o,this},t.prototype.getMatrix=function(){return this.m},t.prototype.setAbsolutePosition=function(t,e){var r=this.m[0],i=this.m[1],a=this.m[2],n=this.m[3],o=this.m[4],s=this.m[5],h=(r*(e-s)-i*(t-o))/(r*n-i*a),l=(t-o-a*h)/r;return this.translate(l,h)},t}();e.Transform=n;var o="[object Array]",s="[object Number]",h="[object String]",l="[object Boolean]",d=Math.PI/180,u=180/Math.PI,c="#",p="",f="0",g="Konva warning: ",y="Konva error: ",m="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},_=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,S=[];e.Util={_isElement:function(t){return!(!t||1!=t.nodeType)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject:function(t){return!!t&&t.constructor===Object},_isArray:function(t){return Object.prototype.toString.call(t)===o},_isNumber:function(t){return Object.prototype.toString.call(t)===s&&!isNaN(t)&&isFinite(t)},_isString:function(t){return Object.prototype.toString.call(t)===h},_isBoolean:function(t){return Object.prototype.toString.call(t)===l},isObject:function(t){return t instanceof Object},isValidSelector:function(t){if("string"!==typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:function(t){return 0===t?0:t>0?1:-1},requestAnimFrame:function(t){S.push(t),1===S.length&&requestAnimationFrame((function(){var t=S;S=[],t.forEach((function(t){t()}))}))},createCanvasElement:function(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){}return t},createImageElement:function(){return document.createElement("img")},_isInDocument:function(t){while(t=t.parentNode)if(t==document)return!0;return!1},_simplifyArray:function(t){var r,i,a=[],n=t.length,o=e.Util;for(r=0;r<n;r++)i=t[r],o._isNumber(i)?i=Math.round(1e3*i)/1e3:o._isString(i)||(i=i.toString()),a.push(i);return a},_urlToImage:function(t,e){var r=new i.glob.Image;r.onload=function(){e(r)},r.src=t},_rgbToHex:function(t,e,r){return((1<<24)+(t<<16)+(e<<8)+r).toString(16).slice(1)},_hexToRgb:function(t){t=t.replace(c,p);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor:function(){var t=(16777215*Math.random()<<0).toString(16);while(t.length<6)t=f+t;return c+t},get:function(t,e){return void 0===t?e:t},getRGB:function(t){var e;return t in v?(e=v[t],{r:e[0],g:e[1],b:e[2]}):t[0]===c?this._hexToRgb(t.substring(1)):t.substr(0,4)===m?(e=_.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(t){return t=t||"black",e.Util._namedColorToRBA(t)||e.Util._hex3ColorToRGBA(t)||e.Util._hex6ColorToRGBA(t)||e.Util._rgbColorToRGBA(t)||e.Util._rgbaColorToRGBA(t)||e.Util._hslColorToRGBA(t)},_namedColorToRBA:function(t){var e=v[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA:function(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA:function(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA:function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA:function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA:function(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),r=(e[0],e.slice(1)),i=Number(r[0])/360,a=Number(r[1])/100,n=Number(r[2])/100,o=void 0,s=void 0,h=void 0;if(0===a)return h=255*n,{r:Math.round(h),g:Math.round(h),b:Math.round(h),a:1};o=n<.5?n*(1+a):n+a-n*a;for(var l=2*n-o,d=[0,0,0],u=0;u<3;u++)s=i+1/3*-(u-1),s<0&&s++,s>1&&s--,h=6*s<1?l+6*(o-l)*s:2*s<1?o:3*s<2?l+(o-l)*(2/3-s)*6:l,d[u]=255*h;return{r:Math.round(d[0]),g:Math.round(d[1]),b:Math.round(d[2]),a:1}}},haveIntersection:function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject:function(t){var e={};for(var r in t)this._isPlainObject(t[r])?e[r]=this.cloneObject(t[r]):this._isArray(t[r])?e[r]=this.cloneArray(t[r]):e[r]=t[r];return e},cloneArray:function(t){return t.slice(0)},_degToRad:function(t){return t*d},_radToDeg:function(t){return t*u},_capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw:function(t){throw new Error(y+t)},error:function(t){console.error(y+t)},warn:function(t){i.Konva.showWarnings&&console.warn(g+t)},extend:function(t,e){function r(){this.constructor=t}r.prototype=e.prototype;var i=t.prototype;for(var a in t.prototype=new r,i)i.hasOwnProperty(a)&&(t.prototype[a]=i[a]);t.__super__=e.prototype,t.super=e},_getControlPoints:function(t,e,r,i,a,n,o){var s=Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2)),h=Math.sqrt(Math.pow(a-r,2)+Math.pow(n-i,2)),l=o*s/(s+h),d=o*h/(s+h),u=r-l*(a-t),c=i-l*(n-e),p=r+d*(a-t),f=i+d*(n-e);return[u,c,p,f]},_expandPoints:function(t,r){var i,a,n=t.length,o=[];for(i=2;i<n-2;i+=2)a=e.Util._getControlPoints(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],r),o.push(a[0]),o.push(a[1]),o.push(t[i]),o.push(t[i+1]),o.push(a[2]),o.push(a[3]);return o},each:function(t,e){for(var r in t)e(r,t[r])},_inRange:function(t,e,r){return e<=t&&t<r},_getProjectionToSegment:function(t,e,r,i,a,n){var o,s,h,l=(t-r)*(t-r)+(e-i)*(e-i);if(0==l)o=t,s=e,h=(a-r)*(a-r)+(n-i)*(n-i);else{var d=((a-t)*(r-t)+(n-e)*(i-e))/l;d<0?(o=t,s=e,h=(t-a)*(t-a)+(e-n)*(e-n)):d>1?(o=r,s=i,h=(r-a)*(r-a)+(i-n)*(i-n)):(o=t+d*(r-t),s=e+d*(i-e),h=(o-a)*(o-a)+(s-n)*(s-n))}return[o,s,h]},_getProjectionToLine:function(t,r,i){var a=e.Util.cloneObject(t),n=Number.MAX_VALUE;return r.forEach((function(o,s){if(i||s!==r.length-1){var h=r[(s+1)%r.length],l=e.Util._getProjectionToSegment(o.x,o.y,h.x,h.y,t.x,t.y),d=l[0],u=l[1],c=l[2];c<n&&(a.x=d,a.y=u,n=c)}})),a},_prepareArrayForTween:function(t,r,i){var a,n=[],o=[];if(t.length>r.length){var s=r;r=t,t=s}for(a=0;a<t.length;a+=2)n.push({x:t[a],y:t[a+1]});for(a=0;a<r.length;a+=2)o.push({x:r[a],y:r[a+1]});var h=[];return o.forEach((function(t){var r=e.Util._getProjectionToLine(t,n,i);h.push(r.x),h.push(r.y)})),h},_prepareToStringify:function(t){var r;for(var i in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(i)&&t[i]&&"object"==typeof t[i])if(r=Object.getOwnPropertyDescriptor(t,i),t[i].visitedByCircularReferenceRemoval||e.Util._isElement(t[i])){if(!r.configurable)return null;delete t[i]}else if(null===e.Util._prepareToStringify(t[i])){if(!r.configurable)return null;delete t[i]}return delete t.visitedByCircularReferenceRemoval,t},_assign:function(t,e){for(var r in e)t[r]=e[r];return t},_getFirstPointerId:function(t){return t.touches?t.changedTouches[0].identifier:999}}},653774:function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var i=r(354417),a=r(468588);function n(t){return a.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||a.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function o(t){return t>255?255:t<0?0:Math.round(t)}function s(t){return t>1?1:t<1e-4?1e-4:t}function h(){if(i.Konva.isUnminified)return function(t,e){return a.Util._isNumber(t)||a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function l(){if(i.Konva.isUnminified)return function(t,e){var r=a.Util._isNumber(t),i="auto"===t;return r||i||a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function d(){if(i.Konva.isUnminified)return function(t,e){return a.Util._isString(t)||a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function u(){if(i.Konva.isUnminified)return function(t,e){return a.Util._isFunction(t)||a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function c(){if(i.Konva.isUnminified)return function(t,e){return a.Util._isArray(t)?t.forEach((function(t){a.Util._isNumber(t)||a.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}function p(){if(i.Konva.isUnminified)return function(t,e){var r=!0===t||!1===t;return r||a.Util.warn(n(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function f(t){if(i.Konva.isUnminified)return function(e,r){return a.Util.isObject(e)||a.Util.warn(n(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}e.RGBComponent=o,e.alphaComponent=s,e.getNumberValidator=h,e.getNumberOrAutoValidator=l,e.getStringValidator=d,e.getFunctionValidator=u,e.getNumberArrayValidator=c,e.getBooleanValidator=p,e.getComponentValidator=f},907643:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=r(468588),n=r(1455),o=r(197955),s=r(653774),h=r(354417),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius()!==t/2&&this.radius(t/2)},e.prototype.setHeight=function(t){this.radius()!==t/2&&this.radius(t/2)},e}(o.Shape);e.Circle=l,l.prototype._centroid=!0,l.prototype.className="Circle",l.prototype._attrsAffectingSize=["radius"],h._registerNode(l),n.Factory.addGetterSetter(l,"radius",0,s.getNumberValidator()),a.Collection.mapMethods(l)},671298:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=r(468588),n=r(1455),o=r(197955),s=r(653774),h=r(354417),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._useBufferCanvas=function(){return!(!this.hasShadow()&&1===this.getAbsoluteOpacity()||!this.hasStroke()||!this.getStage())},e.prototype._sceneFunc=function(t){var e,r,i,a=this.width(),n=this.height(),o=this.image();o&&(e=this.cropWidth(),r=this.cropHeight(),i=e&&r?[o,this.cropX(),this.cropY(),e,r,0,0,a,n]:[o,0,0,a,n]),(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,a,n),t.closePath(),t.fillStrokeShape(this)),o&&t.drawImage.apply(t,i)},e.prototype._hitFunc=function(t){var e=this.width(),r=this.height();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){var t,e=this.image();return t=this.attrs.width,null!==t&&void 0!==t?t:e?e.width:0},e.prototype.getHeight=function(){var t,e=this.image();return t=this.attrs.height,null!==t&&void 0!==t?t:e?e.height:0},e.fromURL=function(t,r){var i=a.Util.createImageElement();i.onload=function(){var t=new e({image:i});r(t)},i.crossOrigin="Anonymous",i.src=t},e}(o.Shape);e.Image=l,l.prototype.className="Image",h._registerNode(l),n.Factory.addGetterSetter(l,"image"),n.Factory.addComponentsGetterSetter(l,"crop",["x","y","width","height"]),n.Factory.addGetterSetter(l,"cropX",0,s.getNumberValidator()),n.Factory.addGetterSetter(l,"cropY",0,s.getNumberValidator()),n.Factory.addGetterSetter(l,"cropWidth",0,s.getNumberValidator()),n.Factory.addGetterSetter(l,"cropHeight",0,s.getNumberValidator()),a.Collection.mapMethods(l)},956067:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=r(468588),n=r(1455),o=r(197955),s=r(558985),h=r(653774),l=r(354417),d=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width"],u="Change.konva",c="none",p="up",f="right",g="down",y="left",m=d.length,v=function(t){function e(e){var r=t.call(this,e)||this;return r.on("add.konva",(function(t){this._addListeners(t.child),this._sync()})),r}return i(e,t),e.prototype.getText=function(){return this.find("Text")[0]},e.prototype.getTag=function(){return this.find("Tag")[0]},e.prototype._addListeners=function(t){var e,r=this,i=function(){r._sync()};for(e=0;e<m;e++)t.on(d[e]+u,i)},e.prototype.getWidth=function(){return this.getText().width()},e.prototype.getHeight=function(){return this.getText().height()},e.prototype._sync=function(){var t,e,r,i,a,n,o,s=this.getText(),h=this.getTag();if(s&&h){switch(t=s.width(),e=s.height(),r=h.pointerDirection(),i=h.pointerWidth(),o=h.pointerHeight(),a=0,n=0,r){case p:a=t/2,n=-1*o;break;case f:a=t+i,n=e/2;break;case g:a=t/2,n=e+o;break;case y:a=-1*i,n=e/2;break}h.setAttrs({x:-1*a,y:-1*n,width:t,height:e}),s.setAttrs({x:-1*a,y:-1*n})}},e}(s.Group);e.Label=v,v.prototype.className="Label",l._registerNode(v),a.Collection.mapMethods(v);var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._sceneFunc=function(t){var e=this.width(),r=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),n=this.pointerHeight(),o=Math.min(this.cornerRadius(),e/2,r/2);t.beginPath(),o?t.moveTo(o,0):t.moveTo(0,0),i===p&&(t.lineTo((e-a)/2,0),t.lineTo(e/2,-1*n),t.lineTo((e+a)/2,0)),o?(t.lineTo(e-o,0),t.arc(e-o,o,o,3*Math.PI/2,0,!1)):t.lineTo(e,0),i===f&&(t.lineTo(e,(r-n)/2),t.lineTo(e+a,r/2),t.lineTo(e,(r+n)/2)),o?(t.lineTo(e,r-o),t.arc(e-o,r-o,o,0,Math.PI/2,!1)):t.lineTo(e,r),i===g&&(t.lineTo((e+a)/2,r),t.lineTo(e/2,r+n),t.lineTo((e-a)/2,r)),o?(t.lineTo(o,r),t.arc(o,r-o,o,Math.PI/2,Math.PI,!1)):t.lineTo(0,r),i===y&&(t.lineTo(0,(r+n)/2),t.lineTo(-1*a,r/2),t.lineTo(0,(r-n)/2)),o&&(t.lineTo(0,o),t.arc(o,o,o,Math.PI,3*Math.PI/2,!1)),t.closePath(),t.fillStrokeShape(this)},e.prototype.getSelfRect=function(){var t=0,e=0,r=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),n=this.width(),o=this.height();return a===p?(e-=i,o+=i):a===g?o+=i:a===y?(t-=1.5*r,n+=r):a===f&&(n+=1.5*r),{x:t,y:e,width:n,height:o}},e}(o.Shape);e.Tag=_,_.prototype.className="Tag",l._registerNode(_),n.Factory.addGetterSetter(_,"pointerDirection",c),n.Factory.addGetterSetter(_,"pointerWidth",0,h.getNumberValidator()),n.Factory.addGetterSetter(_,"pointerHeight",0,h.getNumberValidator()),n.Factory.addGetterSetter(_,"cornerRadius",0,h.getNumberValidator()),a.Collection.mapMethods(_)},275244:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=r(468588),n=r(1455),o=r(197955),s=r(354417),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype._sceneFunc=function(t){var e=this.cornerRadius(),r=this.width(),i=this.height();if(t.beginPath(),e){var a=0,n=0,o=0,s=0;"number"===typeof e?a=n=o=s=Math.min(e,r/2,i/2):(a=Math.min(e[0],r/2,i/2),n=Math.min(e[1],r/2,i/2),s=Math.min(e[2],r/2,i/2),o=Math.min(e[3],r/2,i/2)),t.moveTo(a,0),t.lineTo(r-n,0),t.arc(r-n,n,n,3*Math.PI/2,0,!1),t.lineTo(r,i-s),t.arc(r-s,i-s,s,0,Math.PI/2,!1),t.lineTo(o,i),t.arc(o,i-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,a),t.arc(a,a,a,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,r,i);t.closePath(),t.fillStrokeShape(this)},e}(o.Shape);e.Rect=h,h.prototype.className="Rect",s._registerNode(h),n.Factory.addGetterSetter(h,"cornerRadius",0),a.Collection.mapMethods(h)},723787:function(t,e,r){var i=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a,n=r(468588),o=r(1455),s=r(197955),h=r(354417),l=r(653774),d=r(354417),u="auto",c="center",p="justify",f="Change.konva",g="2d",y="-",m="left",v="text",_="Text",S="top",b="bottom",w="middle",G="normal",C="px ",x=" ",F="right",k="word",T="char",P="none",O="â€¦",R=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],M=R.length;function A(){return a||(a=n.Util.createCanvasElement().getContext(g),a)}function N(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function U(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function E(t){return t=t||{},t.fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}String.prototype.trimRight;var I=function(t){function e(e){var r=t.call(this,E(e))||this;r._partialTextX=0,r._partialTextY=0;for(var i=0;i<M;i++)r.on(R[i]+f,r._setTextData);return r._setTextData(),r}return i(e,t),e.prototype._sceneFunc=function(t){var e,r=this.padding(),i=this.fontSize(),a=this.lineHeight()*i,n=this.textArr,o=n.length,s=this.verticalAlign(),h=0,l=this.align(),d=this.getWidth(),u=this.letterSpacing(),f=this.fill(),g=this.textDecoration(),y=-1!==g.indexOf("underline"),v=-1!==g.indexOf("line-through"),_=0,S=(_=a/2,0),G=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",w),t.setAttr("textAlign",m),s===w?h=(this.getHeight()-o*a-2*r)/2:s===b&&(h=this.getHeight()-o*a-2*r),t.translate(r,h+r),e=0;e<o;e++){S=0,G=0;var C,x,k,T=n[e],P=T.text,O=T.width,R=e!==o-1;if(t.save(),l===F?S+=d-O-2*r:l===c&&(S+=(d-O-2*r)/2),y&&(t.save(),t.beginPath(),t.moveTo(S,_+G+Math.round(i/2)),C=P.split(" ").length-1,x=0===C,k=l===p&&R&&!x?d-2*r:O,t.lineTo(S+Math.round(k),_+G+Math.round(i/2)),t.lineWidth=i/15,t.strokeStyle=f,t.stroke(),t.restore()),v&&(t.save(),t.beginPath(),t.moveTo(S,_+G),C=P.split(" ").length-1,x=0===C,k=l===p&&R&&!x?d-2*r:O,t.lineTo(S+Math.round(k),_+G),t.lineWidth=i/15,t.strokeStyle=f,t.stroke(),t.restore()),0!==u||l===p){C=P.split(" ").length-1;for(var M=0;M<P.length;M++){var A=P[M];" "===A&&e!==o-1&&l===p&&(S+=Math.floor((d-2*r-O)/C)),this._partialTextX=S,this._partialTextY=_+G,this._partialText=A,t.fillStrokeShape(this),S+=Math.round(this.measureSize(A).width)+u}}else this._partialTextX=S,this._partialTextY=_+G,this._partialText=P,t.fillStrokeShape(this);t.restore(),o>1&&(_+=a)}},e.prototype._hitFunc=function(t){var e=this.getWidth(),r=this.getHeight();t.beginPath(),t.rect(0,0,e,r),t.closePath(),t.fillStrokeShape(this)},e.prototype.setText=function(t){var e=n.Util._isString(t)?t:null===t||void 0===t?"":t+"";return this._setAttr(v,e),this},e.prototype.getWidth=function(){var t=this.attrs.width===u||void 0===this.attrs.width;return t?this.getTextWidth()+2*this.padding():this.attrs.width},e.prototype.getHeight=function(){var t=this.attrs.height===u||void 0===this.attrs.height;return t?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height},e.prototype.getTextWidth=function(){return this.textWidth},e.prototype.getTextHeight=function(){return n.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},e.prototype.measureSize=function(t){var e,r=A(),i=this.fontSize();return r.save(),r.font=this._getContextFont(),e=r.measureText(t),r.restore(),{width:e.width,height:i}},e.prototype._getContextFont=function(){return h.Konva.UA.isIE?this.fontStyle()+x+this.fontSize()+C+this.fontFamily():this.fontStyle()+x+this.fontVariant()+x+this.fontSize()+C+this.fontFamily()},e.prototype._addTextLine=function(t){this.align()===p&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})},e.prototype._getTextWidth=function(t){var e=this.letterSpacing(),r=t.length;return A().measureText(t).width+(r?e*(r-1):0)},e.prototype._setTextData=function(){var t=this.text().split("\n"),e=+this.fontSize(),r=0,i=this.lineHeight()*e,a=this.attrs.width,n=this.attrs.height,o=a!==u&&void 0!==a,s=n!==u&&void 0!==n,h=this.padding(),l=a-2*h,d=n-2*h,c=0,p=this.wrap(),f=p!==P,g=p!==T&&f,m=this.ellipsis()&&!f;this.textArr=[],A().font=this._getContextFont();for(var v=m?this._getTextWidth(O):0,_=0,S=t.length;_<S;++_){var b=t[_],w=this._getTextWidth(b);if(o&&w>l)while(b.length>0){var G=0,C=b.length,F="",k=0;while(G<C){var R=G+C>>>1,M=b.slice(0,R+1),N=this._getTextWidth(M)+v;N<=l?(G=R+1,F=M+(m?O:""),k=N):C=R}if(!F)break;if(g){var U,E=b[F.length],I=E===x||E===y;U=I&&k<=l?F.length:Math.max(F.lastIndexOf(x),F.lastIndexOf(y))+1,U>0&&(G=U,F=F.slice(0,G),k=this._getTextWidth(F))}if(F=F.trimRight(),this._addTextLine(F),r=Math.max(r,k),c+=i,!f||s&&c+i>d)break;if(b=b.slice(G),b=b.trimLeft(),b.length>0&&(w=this._getTextWidth(b),w<=l)){this._addTextLine(b),c+=i,r=Math.max(r,w);break}}else this._addTextLine(b),c+=i,r=Math.max(r,w);if(s&&c+i>d)break}this.textHeight=e,this.textWidth=r},e.prototype.getStrokeScaleEnabled=function(){return!0},e}(s.Shape);e.Text=I,I.prototype._fillFunc=N,I.prototype._strokeFunc=U,I.prototype.className=_,I.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight"],d._registerNode(I),o.Factory.overWriteSetter(I,"width",l.getNumberOrAutoValidator()),o.Factory.overWriteSetter(I,"height",l.getNumberOrAutoValidator()),o.Factory.addGetterSetter(I,"fontFamily","Arial"),o.Factory.addGetterSetter(I,"fontSize",12,l.getNumberValidator()),o.Factory.addGetterSetter(I,"fontStyle",G),o.Factory.addGetterSetter(I,"fontVariant",G),o.Factory.addGetterSetter(I,"padding",0,l.getNumberValidator()),o.Factory.addGetterSetter(I,"align",m),o.Factory.addGetterSetter(I,"verticalAlign",S),o.Factory.addGetterSetter(I,"lineHeight",1,l.getNumberValidator()),o.Factory.addGetterSetter(I,"wrap",k),o.Factory.addGetterSetter(I,"ellipsis",!1),o.Factory.addGetterSetter(I,"letterSpacing",0,l.getNumberValidator()),o.Factory.addGetterSetter(I,"text","",l.getStringValidator()),o.Factory.addGetterSetter(I,"textDecoration",""),n.Collection.mapMethods(I)}}]);